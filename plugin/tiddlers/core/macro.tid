title: $:/plugins/EvidentlyCube/TaskList/core-macro
type: text/vnd.tiddlywiki
tags: $:/tags/Macro

\define ec-task-list(tiddler editable:0)
	<$importvariables
		filter="[[$:/plugins/EvidentlyCube/TaskList/Actions/core-save-item]] [[$:/plugins/EvidentlyCube/TaskList/Actions/core-start-item-edit]] [[$:/plugins/EvidentlyCube/TaskList/Actions/core-save-edited-item]]"
	>
	<$let
		tid=<<__tiddler__>>
		tid-base={{{ [<tid>removesuffix[.edit]else<tid>] }}}
		is-editable=<<__editable__>>
		temp=<<qualify "$:/temp/ec-task-list">>
	>
		{{||$:/plugins/EvidentlyCube/TaskList/core-input-row}}
		<div class="ec_tl-tasks">
			<$list filter="[all[tiddlers]tag[TaskList/Item]field:parent<tid-base>!field:_is-done[1]]">
				<$transclude tiddler={{{
					[all[current]field:_is-editing[1]then[$:/plugins/EvidentlyCube/TaskList/core-item-edit]else[$:/plugins/EvidentlyCube/TaskList/core-item]]
				}}}/>
			</$list>
		</div>

		<div class="ec_tl-tasks">
			<$list filter="[all[tiddlers]tag[TaskList/Item]field:parent<tid-base>field:_is-done[1]]">
				<$transclude tiddler={{{
					[all[current]field:_is-editing[1]then[$:/plugins/EvidentlyCube/TaskList/core-item-edit]else[$:/plugins/EvidentlyCube/TaskList/core-item]]
				}}}/>
			</$list>
		</div>
	</$let>
	</$importvariables>
\end